(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{675:function(s,t,a){"use strict";a.r(t);var e=a(74),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"存储过程和存储函数的基本概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储过程和存储函数的基本概念"}},[s._v("#")]),s._v(" 存储过程和存储函数的基本概念")]),s._v(" "),t("p",[s._v("存储过程和存储函数是指存储在数据库中供所有用户调用的子程序。")]),s._v(" "),t("ul",[t("li",[s._v("相同点：完成特定的功能的程序。")]),s._v(" "),t("li",[s._v("不同点：存储函数可以通过一个return字句返回一个函数的值。")])]),s._v(" "),t("h2",{attrs:{id:"存储过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储过程"}},[s._v("#")]),s._v(" 存储过程")]),s._v(" "),t("h3",{attrs:{id:"创建或替换存储过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建或替换存储过程"}},[s._v("#")]),s._v(" 创建或替换存储过程")]),s._v(" "),t("p",[s._v("在Oracle数据库中，使用"),t("code",[s._v("CREATE PROCEDURE")]),s._v("创建一个存储过程，其基本语法为：")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" replace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" 存储过程名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("参数列表"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" \nPL"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v("语句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("as相当于declare，在as之后紧跟着的是说明部分。")]),s._v(" "),t("p",[t("strong",[s._v("注意，存储过程只能创建或替换，不能修改")]),s._v("。")]),s._v(" "),t("p",[s._v("现在，我们创建一个无参的存储过程。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" replace "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" sayhelloworld\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello World!'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"两种调用存储过程的方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#两种调用存储过程的方式"}},[s._v("#")]),s._v(" 两种调用存储过程的方式")]),s._v(" "),t("p",[s._v("调用存储过程有两种方式：")]),s._v(" "),t("ul",[t("li",[s._v("使用"),t("code",[s._v("exec")]),s._v("调用存储过程，例如"),t("code",[s._v("exec sayhelloworld;")])]),s._v(" "),t("li",[s._v("编写PL/SQL调用存储过程")])]),s._v(" "),t("p",[s._v("第一种调用方式")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nexec sayhelloworld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("第二种调用方式")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n  sayhelloworld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  sayhelloworld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"创建带参数的存储过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建带参数的存储过程"}},[s._v("#")]),s._v(" 创建带参数的存储过程")]),s._v(" "),t("p",[s._v("前面我们创建的存储过程是不带参数的，现在，我们创建一个带参数的存储过程。"),t("strong",[s._v("需要注意的是，若一个存储过程带参数，必须使用"),t("code",[s._v("in")]),s._v("或"),t("code",[s._v("out")]),s._v("指明参数是属于输入参数还是输出参数。")])]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" replace "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" raisesalary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("eno "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v("\n psal emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 得到员工涨薪水前的工资")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" sal "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" psal "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" eno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 给员工涨100元")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" eno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'涨前的工资:'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v("psal "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'涨后的工资:'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("psal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("一般情况下，我们不在存储过程或存储函数中使用"),t("code",[s._v("commit")]),s._v("或"),t("code",[s._v("rollback")]),s._v("。因为存储过程和存储函数可能被其它程序多次调用。")]),s._v(" "),t("h2",{attrs:{id:"存储函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储函数"}},[s._v("#")]),s._v(" 存储函数")]),s._v(" "),t("h3",{attrs:{id:"存储函数的定义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储函数的定义"}},[s._v("#")]),s._v(" 存储函数的定义")]),s._v(" "),t("p",[s._v("存储函数和存储过程比较类似，不同的是，它必须指定一个return字句，用于返回函数值。其语法如下：")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" replace "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("参数列表"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" 函数值类型\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" \nplsql子程序体"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("接下来，我们来查询一下某个员工的年收入：")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" replace "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" queryempincome"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("eno "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" number\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 定义变量保存员工的薪水和奖金")]),s._v("\n psal emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pcomm emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("comm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" sal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("comm "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" psal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pcomm "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" eno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 直接返回年收入，有些员工没有奖金，若一个表达式中含义空值，则整个表达式的结果为空，因此需要对奖金使用nvl函数")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" psal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("nvl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pcomm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"调用存储函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#调用存储函数"}},[s._v("#")]),s._v(" 调用存储函数")]),s._v(" "),t("p",[s._v("编写完存储函数以后，我们就可以调用存储函数了。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n eno number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n v_return number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n eno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 赋值")]),s._v("\n v_return "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" queryempincome"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n eno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" eno\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'v_return:'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v("v_return"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 前面的v_return是输出参数，后面的v_return是存储过程的描述，相当于定义的变量；意思是输出的内容为后面v_return变量中的内容")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("v_return"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v("v_return"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"存储过程和存储函数的out参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储过程和存储函数的out参数"}},[s._v("#")]),s._v(" 存储过程和存储函数的out参数")]),s._v(" "),t("p",[s._v("一般来讲，存储过程和存储函数的区别在于，存储函数可以有一个返回值，而存储过程没有返回值。存储过程和存储函数都可以指定一个或多个输出参数。我们可以利用out参数，在过程和函数中实现返回多个值。")]),s._v(" "),t("p",[s._v("总而言之：")]),s._v(" "),t("ul",[t("li",[s._v("存储过程和存储函数都可以有out参数")]),s._v(" "),t("li",[s._v("存储过程和存储函数都可以有多个out参数")]),s._v(" "),t("li",[s._v("存储过程可以通过out参数来实现返回值")])]),s._v(" "),t("p",[t("strong",[s._v("如果只有一个返回值，用存储函数比较好，如果存在多个返回值，则使用存储过程比较好。")])]),s._v(" "),t("p",[s._v("接下来，我们查询一下某个员工的姓名、月薪和职位。由于返回多个值，这里优先使用存储过程。存储过程无法使用return指定返回值，则使用"),t("code",[s._v("out")]),s._v("参数来实现。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" replace "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" queryempinform"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("eno "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pename "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),s._v(" varchar2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("psal "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),s._v(" number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pjob "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),s._v(" varchar2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--  得到员工的姓名、月薪和职位")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" ename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("empjob "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("psal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pempjob "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" eno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"在out参数中使用使用光标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在out参数中使用使用光标"}},[s._v("#")]),s._v(" 在out参数中使用使用光标")]),s._v(" "),t("p",[s._v("至此，我们已经学会了存储过程和存储函数的基本用法，若我们有这样一个需求，需要查询某一个部门所有员工的信息。此时可能输出的信息可能会很多，我们需要定义多个输出参数，这样是相当不方便的。因此，我们可以考虑使用光标。")]),s._v(" "),t("p",[s._v("为了使用光标，我们需要定义一个包结构，包括包头和包体。包头用于声明光标和存储过程，包体完成具体的实现。以下是包头的定义：")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" replace "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" mypackage "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 使用type关键字定义一个类型")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" empcursor "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ref")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" queryEmpList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dno "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("empList "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),s._v(" empcursor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" mypackage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("定义好包头之后，我们完成包体的实现。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" replace "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("body")]),s._v(" mypackage "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" queryEmpList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dno "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("empList "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),s._v(" empcursor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打开光标")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" empList "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" deptno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" queryEmpList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" mypackage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);