(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{674:function(s,t,a){"use strict";a.r(t);var n=a(74),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"pl-sql简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pl-sql简介"}},[s._v("#")]),s._v(" PL/SQL简介")]),s._v(" "),t("p",[s._v("PL/SQL是Oracle对SQL语言的过程化扩展，主要包含两个含义：")]),s._v(" "),t("ul",[t("li",[s._v("PL/SQL是Oracle对SQL语言的扩展")]),s._v(" "),t("li",[s._v("PL/SQL是过程性语言")])]),s._v(" "),t("h2",{attrs:{id:"pl-sql基础语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pl-sql基础语法"}},[s._v("#")]),s._v(" PL/SQL基础语法")]),s._v(" "),t("h3",{attrs:{id:"pl-sql基本类型变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pl-sql基本类型变量"}},[s._v("#")]),s._v(" PL/SQL基本类型变量")]),s._v(" "),t("p",[s._v("首先，我们来看一下PL/SQL的程序结构")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n  说明部分（变量说明、光标说明、例外说明）\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n\t语句序列（DML语句）\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exception")]),s._v("\n   例外处理语句\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("在PL/SQL中可以定义基本类型："),t("code",[s._v("char")]),s._v("、"),t("code",[s._v("varchar2")]),s._v("、"),t("code",[s._v("date")]),s._v("、"),t("code",[s._v("number")]),s._v("、"),t("code",[s._v("boolean")]),s._v("、"),t("code",[s._v("long")]),s._v("这几种变量类型。另外，需要注意的是在PL\\SQL中基本类型变量使用"),t("code",[s._v(":=")]),s._v("对变量进行赋值，且变量名在前，变量类型在后。下面来举一个例子：")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" \n pnumber number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pname varchar2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pdate "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("date")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v(" \n pnumber "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pnumber"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pname "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Tom'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pdate "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" sysdate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pdate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 计算明天的日期")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pdate"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"pl-sql引用型变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pl-sql引用型变量"}},[s._v("#")]),s._v(" PL/SQL引用型变量")]),s._v(" "),t("p",[s._v("PL/SQL引用型变量可以按如下方式定义：")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[s._v("变量名 引用"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("举个例子：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("my_name emp.name%type;\n")])])]),t("p",[s._v("上面的意思是my_name变量使用emp表name字段的类型作为自己的变量类型。如果emp.name是字符串变量，则my_name变量是字符串变量。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 定义引用型变量")]),s._v("\n  \tpename emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  \tpsal emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 得到7839的姓名和薪水")]),s._v("\n \t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" ename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sal "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("psal "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7839")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打印姓名和薪水")]),s._v("\n \tdbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pename "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'的薪水是'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" psal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("在上面的SQL中，我们使用"),t("code",[s._v("into")]),s._v("关键字将查询到的数据赋值给pename,psal这两个变量。需要注意的是，pename,psal顺序和ename,sal变量的顺序需要一一对应。")]),s._v(" "),t("h3",{attrs:{id:"pl-sql记录型变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pl-sql记录型变量"}},[s._v("#")]),s._v(" PL/SQL记录型变量")]),s._v(" "),t("p",[s._v("和引用型变量比较相似的是记录型变量，其定义如下：")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[s._v("变量名 表名"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("rowtype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("这句话的意思就是，我取这一张表中一行的类型作为这个变量，")]),s._v(" "),t("p",[s._v("举个例子：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("emp_rec emp%rowtype;\n")])])]),t("p",[s._v("在一张表中有多个列，因此可以把记录型变量看成是一个数组。如果我们需要引用其中的某一列，则我们可以类似如下方式引用。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[s._v("emp_rec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ADAMS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("下面，我们使用记录型变量来实现和上面同样的功能。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 定义记录型变量")]),s._v("\n emp_rec emp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("rowtype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 得到7839一行的信息 ")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" emp_rec "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7839")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打印姓名和薪水")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emp_rec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'的薪水是'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" emp_rec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"pl-sql中的条件语句"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pl-sql中的条件语句"}},[s._v("#")]),s._v(" PL/SQL中的条件语句")]),s._v(" "),t("p",[s._v("在PL/SQL中，if语句有三种形式：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("第一种:")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" 条件 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" \n 语句"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n 语句"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("第二种:")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" 条件 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" \n 语句"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ELSE")]),s._v(" 语句"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("第三种:")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" 条件"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" 语句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ELSIF")]),s._v(" 条件"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" 语句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ELSE")]),s._v(" 语句"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])]),s._v(" "),t("p",[s._v("下面我们编写一个判断用户从键盘输入的数字的程序。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 接收一个键盘输入，num是一个地址值，在该地址上保存了输入的值。")]),s._v("\naccept num prompt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'请输入一个数字'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" \n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 定义变量保存用户从键盘输入的数字，这里使用&表示取该num中保存的值")]),s._v("\n pnum number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" &num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" pnum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'您输入的数字是0'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" pnum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'您输入的数字是1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" pnum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'您输入的数字是2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'其他数字'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"pl-sql中的循环语句"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pl-sql中的循环语句"}},[s._v("#")]),s._v(" PL/SQL中的循环语句")]),s._v(" "),t("p",[s._v("PL/SQL中循环语句一般有三种形式：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("WHILE循环")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHILE")]),s._v(" 条件 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LOOP")]),s._v("\n 表达式\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LOOP")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("下面来看一个具体的例子，使用WHILE循环打印数字1-10。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" \npnum number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" pnum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pnum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pnum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" pnum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("LOOP循环")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LOOP")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXIT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHEN")]),s._v(" 条件"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n表达式\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LOOP")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("这种循环体和WHILE循环有所区别，当满足条件时，退出循环体。现在，使用LOOP循环实现和上面相同功能的程序。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n\tpnum number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v(" \n\t "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" \n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 退出条件，循环变量的值大于10")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打印该变量的值")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pnum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pnum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" pnum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("FOR循环")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" 变量 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IN")]),s._v(" 取值范围 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LOOP")]),s._v("\n 语句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LOOP")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("接下来，我们实现和前面功能一样的程序。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n pnum number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" pnum "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v("\n  dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pnum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  pnum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" pnum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])]),s._v(" "),t("h2",{attrs:{id:"pl-sql光标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pl-sql光标"}},[s._v("#")]),s._v(" PL/SQL光标")]),s._v(" "),t("p",[s._v("在PL/SQL中，我们使用光标作为结果集，即使用光标代表一个集合。")]),s._v(" "),t("h3",{attrs:{id:"定义光标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#定义光标"}},[s._v("#")]),s._v(" 定义光标")]),s._v(" "),t("p",[s._v("其在PL/SQL中按如下方式定义：")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CURSOR")]),s._v(" 光标名 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("参数名 数据类型"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("参数名 数据类型"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" 语句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"使用光标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用光标"}},[s._v("#")]),s._v(" 使用光标")]),s._v(" "),t("p",[s._v("一般来说，我们使用光标有以下步骤：")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("定义一个光标："),t("code",[s._v("cursor c1 is select ename from emp;")]),s._v("。")])]),s._v(" "),t("li",[t("p",[s._v("打开光标："),t("code",[s._v("open c1;")])])]),s._v(" "),t("li",[t("p",[s._v("取一行光标的值："),t("code",[s._v("fetch c1 into pename;")]),s._v("fetch在其内部维护了一个指针，其有两个作用，一个作用是取出当前指针所指向的记录值，另外一个作用是指向下一条记录。")])]),s._v(" "),t("li",[t("p",[s._v("关闭光标："),t("code",[s._v("close c1;")])])])]),s._v(" "),t("p",[s._v("接下来，我们定义一个光标并循环它用于查询并打印员工的姓名和薪水。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 定义一个光标")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" ename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sal "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 为光标定义对应的变量")]),s._v("\n pename emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n psal emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 取一条记录,注意这里的pename,psal变量的顺序要和光标定义时ename,sal的顺序一致")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("psal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" 没有取到记录"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("在这里，我们需要指定循环退出的条件，否则就会出现死循环。为了这个目的，我们需要使用到光标的属性"),t("code",[s._v("%found")]),s._v("，"),t("code",[s._v("%notfound")]),s._v("。这里，我们使用"),t("code",[s._v("%notfound")]),s._v("属性表示没有取到值。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 定义一个光标")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" ename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sal "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 为光标定义对应的变量")]),s._v("\n pename emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n psal emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 取一条记录,注意这里的pename,psal变量的顺序要和光标定义时ename,sal的顺序一致")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("psal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("notfound"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打印")]),s._v("\ndbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'的薪水是'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v("psal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("接下来，我们使用光标完成给员工涨工资的功能，总裁1000，经理800，其他400。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" empno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("empjob "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pempno emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empno"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pjob emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empjob"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打开光标")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pjob"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("notfound"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" pjob"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PRESIDENT'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" pjob"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'MANAGER'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n  \t "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'涨工资完成'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("执行完这条语句之后，我们发现数据并没有发生变化，因为Oracle数据库默认的事务级别是"),t("code",[s._v("read commit")]),s._v("；")]),s._v(" "),t("p",[s._v("因此，我们还需要手动提交。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" empno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("empjob "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pempno emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empno"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pjob emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empjob"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打开光标")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pjob"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("notfound"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" pjob"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PRESIDENT'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" pjob"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'MANAGER'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n  \t "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sal"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("commit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'涨工资完成'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"光标的属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#光标的属性"}},[s._v("#")]),s._v(" 光标的属性")]),s._v(" "),t("p",[s._v("在PL/SQL中，光标总共有四个属性"),t("code",[s._v("%found")]),s._v("、"),t("code",[s._v("%notfound")]),s._v("、"),t("code",[s._v("isopen")]),s._v("、"),t("code",[s._v("rowcount")]),s._v("。")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("%found")]),s._v("：fetch命令从光标中取到值")]),s._v(" "),t("li",[t("code",[s._v("%notfound")]),s._v("：fetch命令从光标中未取到值")]),s._v(" "),t("li",[t("code",[s._v("isopen")]),s._v("：判断光标是否打开")]),s._v(" "),t("li",[t("code",[s._v("rowcount")]),s._v("：影响的行数")])]),s._v(" "),t("p",[s._v("为了理解后面"),t("code",[s._v("isopen")]),s._v("属性，我们尝试写一个例子。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" empno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("empjob "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  pempno emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empno"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  pjob emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empjob"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("isopen "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    dbms"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'光标已经打开'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" \n    dbms"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'光标没有打开'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("为了理解光标的"),t("code",[s._v("%rowcount")]),s._v("属性，我们再写一个例子。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" empno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("empjob "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  pempno emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empno"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  pjob emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empjob"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pempno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pjob"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("notfound"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rowcount:'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("rowcount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("查看"),t("code",[s._v("%rowcount")]),s._v("显示的是每次循环取出的记录数，而不是总行数。")]),s._v(" "),t("h3",{attrs:{id:"光标数限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#光标数限制"}},[s._v("#")]),s._v(" 光标数限制")]),s._v(" "),t("p",[s._v("默认情况下，Oracle只允许在同一个会话中，打开300个光标。可以通过以下设置进行修改。例如，我们可以修改打开光标数为400。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" system "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" open_cursors "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v(" scope "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("both")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("注意scope的取值有三个"),t("code",[s._v("both")]),s._v("、"),t("code",[s._v("memory")]),s._v("、"),t("code",[s._v("spfile")]),s._v("。")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("memory")]),s._v("表示只更改当前实例，不更改参数文件。")]),s._v(" "),t("li",[t("code",[s._v("spfile")]),s._v("表示只更改参数文件，不更改当前实例，需要重启数据库。")]),s._v(" "),t("li",[t("code",[s._v("both")]),s._v("表示既更改参数文件，也更改当前实例")])]),s._v(" "),t("h3",{attrs:{id:"带参数的光标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#带参数的光标"}},[s._v("#")]),s._v(" 带参数的光标")]),s._v(" "),t("p",[s._v("回顾光标的定义，可以发现，光标是可以定义参数的。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CURSOR")]),s._v(" 光标名 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("参数名 数据类型"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("参数名 数据类型"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" 语句"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("接下来我们来举一个例子，查询某个部门中员工的姓名。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dno number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" ename "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" deptno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n pename emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打开光标")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("notfound"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"例外-异常"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#例外-异常"}},[s._v("#")]),s._v(" 例外（异常）")]),s._v(" "),t("p",[s._v("例外是程序设计语言提供的一项功能，用于增强程序的健壮性和容错性。")]),s._v(" "),t("p",[s._v("Oracle中存在两种例外，一种是系统例外，另外一种是自定义例外。")]),s._v(" "),t("h3",{attrs:{id:"系统例外的分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统例外的分类"}},[s._v("#")]),s._v(" 系统例外的分类")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("No_data_found：没有找到数据")])]),s._v(" "),t("li",[t("p",[s._v("Too _many_rows: (select ... into 语句匹配多个行)")])]),s._v(" "),t("li",[t("p",[s._v("Zero_divide：（被零除）")])]),s._v(" "),t("li",[t("p",[s._v("Value_error：（算术或转换错误）")])]),s._v(" "),t("li",[t("p",[s._v("Time_on_resource：（在等待资源时发生超时）")])])]),s._v(" "),t("p",[s._v("首先，我们尝试举一个No_data_found例外的例子")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" servertoutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n  pename emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查询员工号为1234的员工姓名")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" ename "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pename "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" empno"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exception")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" no_data_found "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'没有找到该员工'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("others")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'其他例外'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("由于没有员工号为1234的员工，所以程序将"),t("code",[s._v("no_data_found")]),s._v("抛出异常。在这个程序中，我们使用exception捕获"),t("code",[s._v("no_data_found")]),s._v("例外，并使用"),t("code",[s._v("when... then")]),s._v("处理它。运行程序可以发现它抛出了一个"),t("code",[s._v("no_data_found")]),s._v("异常。")]),s._v(" "),t("p",[s._v("接下来，我们尝试一下"),t("code",[s._v("too_many_rows")]),s._v("异常。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n  pename emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查询所有10号部门的员工姓名")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" ename "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pename "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" deptno"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exception")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" too_many_rows "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'select into匹配了多行'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("others")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'其他例外'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("由于10号部门的员工有多个，所以如果执行程序，程序打印出"),t("code",[s._v("select into匹配了多行")]),s._v("。")]),s._v(" "),t("p",[s._v("接下来，我们再举一个"),t("code",[s._v("zero_divide")]),s._v("例外。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" \n pnum number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n\tpnum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exception")]),s._v(" zero_divide "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1:0不能做除数'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ndbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1:0不能做除数'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("others")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'其他例外'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("运行程序，可以看到将抛出"),t("code",[s._v("zero_divide")]),s._v("异常。")]),s._v(" "),t("p",[s._v("最后，我们来看一个算术或转换错误，在这里我们将一个字符串赋值给一个number类型的变量。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 定义一个number类型的变量")]),s._v("\n pnum number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n pnum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'abc'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" value_error "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'算术或者转换异常'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("others")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'其他例外'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("运行程序，程序打印出"),t("code",[s._v("算术或者转换异常")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"自定义例外"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自定义例外"}},[s._v("#")]),s._v(" 自定义例外")]),s._v(" "),t("p",[s._v("在Oracle中，我们可以像定义一个变量一样定义一个例外，只是变量的类型为exception，并使用raise抛出一个例外。接下来我们举一个例子，自定义一个例外。")]),s._v(" "),t("div",{staticClass:"language-plsql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-plsql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" serveroutput "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" ename "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" deptno"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tpename emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tno_emp_exception "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exception")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打开光标")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" cemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" pename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("notfound "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" \n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 抛出异常")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" no_emp_found"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 关闭光标")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" cemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" no_emp_found "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'没有找到员工'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("others")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" dbms_output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("put_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'其他例外'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("执行程序，抛出自定义异常"),t("code",[s._v("no_emp_found")]),s._v("。当然，这里有一个问题，当为我们抛出异常后，无法再执行关闭光标的程序。Oracle检测到程序异常退出时，会自动启动一个process monitor进程做善后处理。")])])}),[],!1,null,null,null);t.default=e.exports}}]);